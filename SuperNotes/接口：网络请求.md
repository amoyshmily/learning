接口：网络请求

我们要知道post请求四种传送正文方式首先需要先了解一下常见的四种编码方式：

HTTP 协议规定 POST 提交的数据必须放在消息主体（entity-body）中，但协议并没有规定数据必须使用什么编码方式。常见的四种编码方式如下：

1、application/x-www-form-urlencoded

这应该是最常见的 POST 提交数据的方式了。浏览器的原生 form 表单，如果不设置 enctype 属性，那么最终就会以 application/x-www-form-urlencoded 方式提交数据。请求类似于下面这样（无关的请求头在本文中都省略掉了）：

```
POST http://www.example.com HTTP/1.1    Content-Type:
application/x-www-form-urlencoded;charset=utf-8
title=test&sub%5B%5D=1&sub%5B%5D=2&sub%5B%5D=3

```


2、multipart/form-data
除了传统的application/x-www-form-urlencoded表单，我们另一个经常用到的是上传文件用的表单，这种表单的类型为multipart/form-data。   这又是一个常见的 POST 数据提交的方式。我们使用表单上传文件时，必须让 form 的 enctyped 等于这个值，下面是示例

```
POST http://www.example.com HTTP/1.1
Content-Type:multipart/form-data; boundary=----WebKitFormBoundaryrGKCBY7qhFd3TrwA
------WebKitFormBoundaryrGKCBY7qhFd3TrwA
Content-Disposition: form-data; name="text"
title
------WebKitFormBoundaryrGKCBY7qhFd3TrwA
Content-Disposition: form-data; name="file"; filename="chrome.png"
Content-Type: image/png
PNG ... content of chrome.png ...
------WebKitFormBoundaryrGKCBY7qhFd3TrwA--

```

3、application/json

application/json 这个 Content-Type 作为响应头大家肯定不陌生。实际上，现在越来越多的人把它作为请求头，用来告诉服务端消息主体是序列化后的 JSON 字符串。由于 JSON 规范的流行，除了低版本 IE 之外的各大浏览器都原生支持 JSON.stringify，服务端语言也都有处理 JSON 的函数，使用 JSON 不会遇上什么麻烦。



4、text/xml

它是一种使用 HTTP 作为传输协议，XML 作为编码方式的远程调用规范。





post请求四种传送正文方式：

（1）请求正文是application/x-www-form-urlencoded

```
requests.post(url='',data={'key1':'value1','key2':'value2'},headers={'Content-Type':'application/x-www-form-urlencoded'})


url = 'https://httpbin.org/post'
d = {'key1': 'value1', 'key2': 'value2'}
r = requests.post(url, data=d)
print r.text

```

（2）请求正文是multipart/form-data
```
requests.post(url='',data={'key1':'value1','key2':'value2'},headers={'Content-Type':'multipart/form-data'})


发送文件中的数据需要（安装requests_toolbelt）

from requests_toolbelt import MultipartEncoder
import requests
 
m = MultipartEncoder(
    fields={'field0': 'value', 'field1': 'value',
            'field2': ('filename', open('file.py', 'rb'), 'text/plain')}
    )
 
r = requests.post('https://httpbin.org/post', data=m,
                  headers={'Content-Type': m.content_type})

不需要文件的情况

from requests_toolbelt import MultipartEncoder
import requests
 
m = MultipartEncoder(fields={'field0': 'value', 'field1': 'value'})
 
r = requests.post('https://httpbin.org/post', data=m,
                  headers={'Content-Type': m.content_type}
```

（3）请求正文是raw
```
♦传入xml格式文本
requests.post(url='',data='<?xml  ?>',headers={'Content-Type':'text/xml'})
♦传入json格式文本
requests.post(url='',data=json.dumps({'key1':'value1','key2':'value2'}),headers={'Content-Type':'application/json'})

或者
requests.post(url='',json={{'key1':'value1','key2':'value2'}},headers={'Content-Type':'application/json'})


```
（4）请求正文是binary
```
requests.post(url='',files={'file':open('test.xls','rb')},headers={'Content-Type':'binary'})


也支持以multipart形式发送post请求，只需将一文件传给requests.post()的files参数即可。
url = 'https://httpbin.org/post'
files = {'file': open('report.txt', 'rb')}
r = requests.post(url, files=files)
print r.text

```